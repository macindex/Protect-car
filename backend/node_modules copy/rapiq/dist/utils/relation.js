"use strict";
/*
 * Copyright (c) 2021-2022.
 * Author Peter Placzek (tada5hi)
 * For the full copyright and license information,
 * view the LICENSE file that was distributed with this source code.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.buildFieldWithAlias = exports.isAllowedByRelations = void 0;
const field_1 = require("./field");
const constants_1 = require("../constants");
function isAllowedByRelations(field, includes, defaultAlias) {
    if (typeof includes === 'undefined') {
        return true;
    }
    const details = typeof field === 'string' ?
        (0, field_1.getFieldDetails)(field) :
        field;
    // check if field is associated to the default domain.
    if (typeof details.path === 'undefined' &&
        typeof details.alias === 'undefined') {
        return true;
    }
    // check if field is associated to the default domain.
    if (details.path === defaultAlias ||
        details.alias === defaultAlias ||
        details.alias === constants_1.DEFAULT_ALIAS_ID) {
        return true;
    }
    return includes.some((include) => include.value === details.path || include.value === details.alias);
}
exports.isAllowedByRelations = isAllowedByRelations;
function buildFieldWithAlias(field, defaultAlias) {
    const details = typeof field === 'string' ?
        (0, field_1.getFieldDetails)(field) :
        field;
    return defaultAlias || details.alias ?
        `${details.alias || defaultAlias}.${details.name}` :
        details.name;
}
exports.buildFieldWithAlias = buildFieldWithAlias;
//# sourceMappingURL=relation.js.map