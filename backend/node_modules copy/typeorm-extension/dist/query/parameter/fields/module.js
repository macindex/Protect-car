"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.applyFields = exports.applyQueryFields = exports.applyQueryFieldsParseOutput = void 0;
const rapiq_1 = require("rapiq");
/**
 * Apply parsed fields parameter data on the db query.
 *
 * @param query
 * @param data
 */
/* istanbul ignore next */
function applyQueryFieldsParseOutput(query, data, extendSelection) {
    if (data.length === 0) {
        return data;
    }
    if (extendSelection) {
        query.addSelect(data.map((field) => {
            const prefix = (field.alias ? `${field.alias}.` : '');
            return `${prefix}${field.key}`;
        }));
    }
    else {
        query.select(data.map((field) => {
            const prefix = (field.alias ? `${field.alias}.` : '');
            return `${prefix}${field.key}`;
        }));
    }
    return data;
}
exports.applyQueryFieldsParseOutput = applyQueryFieldsParseOutput;
/**
 * Apply raw fields parameter data on the db query.
 *
 * @param query
 * @param data
 * @param options
 */
function applyQueryFields(query, data, options) {
    return applyQueryFieldsParseOutput(query, (0, rapiq_1.parseQueryFields)(data, options));
}
exports.applyQueryFields = applyQueryFields;
/**
 * Apply raw fields parameter data on the db query.
 *
 * @param query
 * @param data
 * @param options
 */
function applyFields(query, data, options) {
    return applyQueryFields(query, data, options);
}
exports.applyFields = applyFields;
//# sourceMappingURL=module.js.map